<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JPYC Survey - „Ç¢„É≥„Ç±„Éº„Éà„Å´Á≠î„Åà„Å¶JPYC„Çí„Ç≤„ÉÉ„ÉàÔºÅ</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; }
        .jpyc-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .pulse-animation {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [currentView, setCurrentView] = useState('dashboard');
            const [userBalance, setUserBalance] = useState(0);
            const [completedSurveys, setCompletedSurveys] = useState([]);
            const [selectedSurvey, setSelectedSurvey] = useState(null);
            const [surveyAnswers, setSurveyAnswers] = useState({});
            const [walletAddress, setWalletAddress] = useState('');
            const [isConnected, setIsConnected] = useState(false);

            const surveys = [
                {
                    id: 1,
                    title: "Web3„Å´Èñ¢„Åô„ÇãÊÑèË≠òË™øÊüª",
                    reward: 50,
                    estimatedTime: "3ÂàÜ",
                    category: "„ÉÜ„ÇØ„Éé„É≠„Ç∏„Éº",
                    questions: [
                        {
                            id: 'q1',
                            question: "ÊöóÂè∑Ë≥áÁî£„Çí‰øùÊúâ„Åó„Å¶„ÅÑ„Åæ„Åô„ÅãÔºü",
                            type: 'single',
                            options: ["„ÅØ„ÅÑ", "„ÅÑ„ÅÑ„Åà", "ÈÅéÂéª„Å´‰øùÊúâ„Åó„Å¶„ÅÑ„Åü"]
                        },
                        {
                            id: 'q2',
                            question: "JPYC„Çí‰Ωø„Å£„Åü„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÅãÔºü",
                            type: 'single',
                            options: ["È†ªÁπÅ„Å´‰Ωø„ÅÜ", "„Åü„Åæ„Å´‰Ωø„ÅÜ", "‰Ωø„Å£„Åü„Åì„Å®„Åå„Å™„ÅÑ", "JPYC„ÇíÁü•„Çâ„Å™„ÅÑ"]
                        },
                        {
                            id: 'q3',
                            question: "„Çπ„ÉÜ„Éº„Éñ„É´„Ç≥„Ç§„É≥„ÅÆ‰∏ª„Å™Âà©Áî®ÁõÆÁöÑ„ÅØÔºüÔºàË§áÊï∞ÈÅ∏ÊäûÂèØÔºâ",
                            type: 'multiple',
                            options: ["ÈÄÅÈáë", "Ê±∫Ê∏à", "DeFiÈÅãÁî®", "‰æ°ÂÄ§„ÅÆ‰øùÂ≠ò", "„Åù„ÅÆ‰ªñ"]
                        }
                    ]
                },
                {
                    id: 2,
                    title: "„Ç™„É≥„É©„Ç§„É≥„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞ÁøíÊÖ£Ë™øÊüª",
                    reward: 30,
                    estimatedTime: "2ÂàÜ",
                    category: "„É©„Ç§„Éï„Çπ„Çø„Ç§„É´",
                    questions: [
                        {
                            id: 'q1',
                            question: "Êúà„Å´„Å©„ÅÆ„Åè„Çâ„ÅÑ„Ç™„É≥„É©„Ç§„É≥„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞„Çí„Åó„Åæ„Åô„ÅãÔºü",
                            type: 'single',
                            options: ["ÈÄ±„Å´Ë§áÊï∞Âõû", "ÈÄ±1ÂõûÁ®ãÂ∫¶", "Êúà2-3Âõû", "Êúà1Âõû‰ª•‰∏ã"]
                        },
                        {
                            id: 'q2',
                            question: "„Çà„ÅèÂà©Áî®„Åô„ÇãEC„Çµ„Ç§„Éà„ÅØÔºü",
                            type: 'multiple',
                            options: ["Amazon", "Ê•ΩÂ§©", "Yahoo!„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞", "„É°„É´„Ç´„É™", "„Åù„ÅÆ‰ªñ"]
                        }
                    ]
                },
                {
                    id: 3,
                    title: "„É™„É¢„Éº„Éà„ÉØ„Éº„ÇØ„Å´Èñ¢„Åô„Çã„Ç¢„É≥„Ç±„Éº„Éà",
                    reward: 40,
                    estimatedTime: "3ÂàÜ",
                    category: "ÂÉç„ÅçÊñπ",
                    questions: [
                        {
                            id: 'q1',
                            question: "ÁèæÂú®„ÅÆÂã§ÂãôÂΩ¢ÊÖã„ÅØÔºü",
                            type: 'single',
                            options: ["ÂÆåÂÖ®„É™„É¢„Éº„Éà", "„Éè„Ç§„Éñ„É™„ÉÉ„Éâ", "ÂÆåÂÖ®Âá∫Á§æ", "„Éï„É™„Éº„É©„É≥„Çπ"]
                        },
                        {
                            id: 'q2',
                            question: "ÁêÜÊÉ≥ÁöÑ„Å™Âá∫Á§æÈ†ªÂ∫¶„ÅØÔºü",
                            type: 'single',
                            options: ["ÂÆåÂÖ®Âú®ÂÆÖ", "ÈÄ±1-2Êó•Âá∫Á§æ", "ÈÄ±3-4Êó•Âá∫Á§æ", "ÊØéÊó•Âá∫Á§æ"]
                        }
                    ]
                }
            ];

            const connectWallet = () => {
                // „Ç¶„Ç©„É¨„ÉÉ„ÉàÊé•Á∂ö„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
                const mockAddress = "0x" + Math.random().toString(16).substr(2, 40);
                setWalletAddress(mockAddress);
                setIsConnected(true);
            };

            const startSurvey = (survey) => {
                if (!isConnected) {
                    alert("„Åæ„Åö„Ç¶„Ç©„É¨„ÉÉ„Éà„ÇíÊé•Á∂ö„Åó„Å¶„Åè„Å†„Åï„ÅÑ");
                    return;
                }
                setSelectedSurvey(survey);
                setCurrentView('survey');
                setSurveyAnswers({});
            };

            const handleAnswer = (questionId, answer) => {
                setSurveyAnswers(prev => ({
                    ...prev,
                    [questionId]: answer
                }));
            };

            const completeSurvey = () => {
                const allQuestionsAnswered = selectedSurvey.questions.every(
                    q => surveyAnswers[q.id] && surveyAnswers[q.id].length > 0
                );

                if (!allQuestionsAnswered) {
                    alert("„Åô„Åπ„Å¶„ÅÆË≥™Âïè„Å´ÂõûÁ≠î„Åó„Å¶„Åè„Å†„Åï„ÅÑ");
                    return;
                }

                // Â†±ÈÖ¨„ÇíËøΩÂä†
                setUserBalance(prev => prev + selectedSurvey.reward);
                setCompletedSurveys(prev => [...prev, selectedSurvey.id]);
                
                // „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÈÄöÁü•
                alert(`üéâ „Ç¢„É≥„Ç±„Éº„ÉàÂÆå‰∫ÜÔºÅ${selectedSurvey.reward} JPYC„ÇíÁç≤Âæó„Åó„Åæ„Åó„ÅüÔºÅ`);
                
                setCurrentView('dashboard');
                setSelectedSurvey(null);
            };

            const Header = () => (
                <div className="jpyc-gradient text-white p-4 shadow-lg">
                    <div className="container mx-auto flex justify-between items-center">
                        <div className="flex items-center space-x-3">
                            <div className="text-2xl font-bold">üí∞</div>
                            <h1 className="text-2xl font-bold">JPYC Survey</h1>
                        </div>
                        <div className="flex items-center space-x-4">
                            {isConnected ? (
                                <>
                                    <div className="bg-white/20 rounded-lg px-4 py-2">
                                        <span className="text-sm">ÊÆãÈ´ò:</span>
                                        <span className="text-xl font-bold ml-2">{userBalance} JPYC</span>
                                    </div>
                                    <div className="bg-white/20 rounded-lg px-4 py-2">
                                        <span className="text-sm">
                                            {walletAddress.slice(0, 6)}...{walletAddress.slice(-4)}
                                        </span>
                                    </div>
                                </>
                            ) : (
                                <button 
                                    onClick={connectWallet}
                                    className="bg-white text-purple-600 px-6 py-2 rounded-lg font-bold hover:bg-gray-100 transition"
                                >
                                    „Ç¶„Ç©„É¨„ÉÉ„ÉàÊé•Á∂ö
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );

            const Dashboard = () => (
                <div className="container mx-auto p-6">
                    <div className="mb-8">
                        <h2 className="text-3xl font-bold mb-2">„Ç¢„É≥„Ç±„Éº„Éà‰∏ÄË¶ß</h2>
                        <p className="text-gray-600">„Ç¢„É≥„Ç±„Éº„Éà„Å´Á≠î„Åà„Å¶JPYC„ÇíÁç≤Âæó„Åó„Åæ„Åó„Çá„ÅÜÔºÅ</p>
                    </div>

                    <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {surveys.map(survey => {
                            const isCompleted = completedSurveys.includes(survey.id);
                            return (
                                <div key={survey.id} className="bg-white rounded-xl card-shadow p-6 hover:transform hover:scale-105 transition-all">
                                    <div className="flex justify-between items-start mb-4">
                                        <span className="bg-purple-100 text-purple-600 text-xs px-2 py-1 rounded-full">
                                            {survey.category}
                                        </span>
                                        <div className="text-right">
                                            <div className="text-2xl font-bold text-purple-600">{survey.reward}</div>
                                            <div className="text-xs text-gray-500">JPYC</div>
                                        </div>
                                    </div>
                                    
                                    <h3 className="text-lg font-bold mb-2">{survey.title}</h3>
                                    <div className="flex items-center text-sm text-gray-500 mb-4">
                                        <span>‚è± Á¥Ñ{survey.estimatedTime}</span>
                                        <span className="mx-2">‚Ä¢</span>
                                        <span>üìù {survey.questions.length}Âïè</span>
                                    </div>
                                    
                                    {isCompleted ? (
                                        <button className="w-full bg-gray-200 text-gray-500 py-3 rounded-lg font-bold cursor-not-allowed">
                                            ‚úÖ ÂõûÁ≠îÊ∏à„Åø
                                        </button>
                                    ) : (
                                        <button 
                                            onClick={() => startSurvey(survey)}
                                            className="w-full jpyc-gradient text-white py-3 rounded-lg font-bold hover:opacity-90 transition"
                                        >
                                            „Ç¢„É≥„Ç±„Éº„Éà„ÇíÈñãÂßã
                                        </button>
                                    )}
                                </div>
                            );
                        })}
                    </div>

                    <div className="mt-12 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-8">
                        <h3 className="text-2xl font-bold mb-4">üéØ ‰ªäÊúà„ÅÆÂÆüÁ∏æ</h3>
                        <div className="grid md:grid-cols-3 gap-6">
                            <div className="bg-white rounded-lg p-4">
                                <div className="text-3xl font-bold text-purple-600">{completedSurveys.length}</div>
                                <div className="text-gray-600">ÂÆå‰∫Ü„Åó„Åü„Ç¢„É≥„Ç±„Éº„Éà</div>
                            </div>
                            <div className="bg-white rounded-lg p-4">
                                <div className="text-3xl font-bold text-purple-600">{userBalance}</div>
                                <div className="text-gray-600">Áç≤Âæó„Åó„ÅüJPYC</div>
                            </div>
                            <div className="bg-white rounded-lg p-4">
                                <div className="text-3xl font-bold text-purple-600">
                                    {surveys.length - completedSurveys.length}
                                </div>
                                <div className="text-gray-600">ÊÆã„Çä„ÅÆ„Ç¢„É≥„Ç±„Éº„Éà</div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const SurveyView = () => {
                const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
                const currentQuestion = selectedSurvey.questions[currentQuestionIndex];
                const progress = ((currentQuestionIndex + 1) / selectedSurvey.questions.length) * 100;

                const handleNext = () => {
                    if (!surveyAnswers[currentQuestion.id] || surveyAnswers[currentQuestion.id].length === 0) {
                        alert("ÂõûÁ≠î„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ");
                        return;
                    }

                    if (currentQuestionIndex < selectedSurvey.questions.length - 1) {
                        setCurrentQuestionIndex(prev => prev + 1);
                    } else {
                        completeSurvey();
                    }
                };

                const handleOptionClick = (option) => {
                    if (currentQuestion.type === 'single') {
                        handleAnswer(currentQuestion.id, [option]);
                    } else {
                        const currentAnswers = surveyAnswers[currentQuestion.id] || [];
                        if (currentAnswers.includes(option)) {
                            handleAnswer(currentQuestion.id, currentAnswers.filter(a => a !== option));
                        } else {
                            handleAnswer(currentQuestion.id, [...currentAnswers, option]);
                        }
                    }
                };

                return (
                    <div className="container mx-auto p-6 max-w-2xl">
                        <div className="bg-white rounded-xl card-shadow p-8">
                            <div className="mb-6">
                                <div className="flex justify-between items-center mb-2">
                                    <h2 className="text-xl font-bold">{selectedSurvey.title}</h2>
                                    <span className="text-purple-600 font-bold">{selectedSurvey.reward} JPYC</span>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-2">
                                    <div className="jpyc-gradient h-2 rounded-full transition-all" style={{width: `${progress}%`}}></div>
                                </div>
                                <div className="text-sm text-gray-500 mt-2">
                                    Ë≥™Âïè {currentQuestionIndex + 1} / {selectedSurvey.questions.length}
                                </div>
                            </div>

                            <div className="mb-8">
                                <h3 className="text-lg font-bold mb-4">{currentQuestion.question}</h3>
                                {currentQuestion.type === 'multiple' && (
                                    <p className="text-sm text-gray-500 mb-4">ÔºàË§áÊï∞ÈÅ∏ÊäûÂèØÔºâ</p>
                                )}
                                
                                <div className="space-y-3">
                                    {currentQuestion.options.map(option => {
                                        const isSelected = (surveyAnswers[currentQuestion.id] || []).includes(option);
                                        return (
                                            <button
                                                key={option}
                                                onClick={() => handleOptionClick(option)}
                                                className={`w-full text-left p-4 rounded-lg border-2 transition-all ${
                                                    isSelected 
                                                        ? 'border-purple-500 bg-purple-50' 
                                                        : 'border-gray-200 hover:border-purple-300'
                                                }`}
                                            >
                                                <div className="flex items-center">
                                                    <div className={`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${
                                                        isSelected ? 'border-purple-500' : 'border-gray-300'
                                                    }`}>
                                                        {isSelected && (
                                                            <div className="w-3 h-3 bg-purple-500 rounded-full"></div>
                                                        )}
                                                    </div>
                                                    {option}
                                                </div>
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                            <div className="flex justify-between">
                                <button 
                                    onClick={() => setCurrentView('dashboard')}
                                    className="px-6 py-3 text-gray-600 hover:text-gray-800 transition"
                                >
                                    ‰∏≠Êñ≠„Åô„Çã
                                </button>
                                <button 
                                    onClick={handleNext}
                                    className="jpyc-gradient text-white px-8 py-3 rounded-lg font-bold hover:opacity-90 transition"
                                >
                                    {currentQuestionIndex === selectedSurvey.questions.length - 1 ? 'ÂÆå‰∫Ü„Åô„Çã' : 'Ê¨°„Å∏'}
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <Header />
                    {currentView === 'dashboard' && <Dashboard />}
                    {currentView === 'survey' && selectedSurvey && <SurveyView />}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>